/* Modern Button Styles for Academic Website - Phase 3.1 Refactor */

/* ========================================= */
/* BASE BUTTON STYLES                        */
/* ========================================= */

/**
 * Modern button system using data attributes
 * Usage: <button data-variant="primary" data-size="md">Click me</button>
 * 
 * Attributes:
 * - data-variant: primary | secondary | tertiary | outline | ghost | danger | glass
 * - data-size: xs | sm | md | lg | xl
 * - data-loading: true (for loading state)
 * - data-icon-only: true (for icon-only buttons)
 * - data-block: true (for full-width buttons)
 */

@layer components {
	.btn,
	[data-button],
	button:not([class]) {
		/* Layout */
		display: inline-flex;
		align-items: center;
		justify-content: center;
		position: relative;

		/* Typography */
		font-family: inherit;
		font-weight: var(--font-weight-medium);
		font-size: var(--font-size-base);
		line-height: var(--line-height-tight);
		letter-spacing: var(--letter-spacing-wide);
		text-align: center;
		text-decoration: none;
		white-space: nowrap;

		/* Spacing - Default to 'md' size */
		padding: var(--spacing-3) var(--spacing-6);
		gap: var(--spacing-2);

		/* Appearance */
		border: var(--border-width-thin) solid transparent;
		border-radius: var(--border-radius-lg);
		background: transparent;
		color: inherit;
		cursor: pointer;
		overflow: hidden;
		isolation: isolate;

		/* Behavior */
		-webkit-user-select: none;
		user-select: none;
		-webkit-tap-highlight-color: transparent;
		touch-action: manipulation;

		/* Animation */
		transition:
			background var(--motion-duration-fast) var(--motion-ease-standard),
			border-color var(--motion-duration-fast) var(--motion-ease-standard),
			color var(--motion-duration-fast) var(--motion-ease-standard),
			box-shadow var(--motion-duration-fast) var(--motion-ease-standard),
			transform var(--motion-duration-fast) var(--motion-ease-out);
		transform: translateZ(0);
	}

	/* Remove default focus outline */
	.btn:focus,
	[data-button]:focus,
	button:not([class]):focus {
		outline: none;
	}

	/* Custom focus-visible styling */
	.btn:focus-visible,
	[data-button]:focus-visible,
	button:not([class]):focus-visible {
		outline: var(--border-width-medium) solid var(--color-primary);
		outline-offset: var(--border-width-medium);
	}

	/* Subtle depth effect overlay */
	.btn::before,
	[data-button]::before {
		content: '';
		position: absolute;
		inset: 0;
		border-radius: inherit;
		background: linear-gradient(
			to bottom,
			rgba(var(--color-white-rgb), var(--opacity-low)) 0%,
			rgba(var(--color-white-rgb), 0) 50%,
			rgba(var(--color-black-rgb), var(--opacity-very-low)) 100%
		);
		pointer-events: none;
		opacity: 0;
		transition: opacity var(--motion-duration-fast) ease;
	}

	/* Active state - subtle press effect */
	.btn:active:not(:disabled):not([data-loading]),
	[data-button]:active:not(:disabled):not([data-loading]) {
		transform: scale(0.98);
	}

	/* ========================================= */
	/* BUTTON VARIANTS (data-variant)            */
	/* ========================================= */

	/* ========================================= */
	/* BUTTON VARIANTS (data-variant)            */
	/* ========================================= */

	/* Primary Button - Default solid button */
	.btn-primary,
	[data-variant='primary'] {
		background: linear-gradient(
			135deg,
			var(--color-primary) 0%,
			color-mix(in srgb, var(--color-primary) 85%, var(--accent-secondary)) 100%
		);
		color: var(--text-inverse);
		border-color: transparent;
		box-shadow:
			var(--shadow-sm),
			inset 0 var(--border-width-thin) 0 rgba(var(--color-white-rgb), var(--opacity-low));
	}

	.btn-primary:hover:not(:disabled):not([data-loading]),
	[data-variant='primary']:hover:not(:disabled):not([data-loading]) {
		background: linear-gradient(
			135deg,
			color-mix(in srgb, var(--color-primary) 90%, var(--color-black)),
			color-mix(in srgb, var(--accent-secondary) 90%, var(--color-black))
		);
		box-shadow:
			var(--shadow-md),
			inset 0 var(--border-width-thin) 0 rgba(var(--color-white-rgb), var(--opacity-low));
		transform: translateY(-1px);
	}

	.btn-primary::before,
	[data-variant='primary']::before {
		opacity: var(--opacity-high);
	}

	/* Secondary Button - Subtle background */
	.btn-secondary,
	[data-variant='secondary'] {
		background: var(--surface-muted);
		color: var(--text-primary);
		border-color: var(--border-subtle);
		box-shadow: var(--shadow-xs);
	}

	.btn-secondary:hover:not(:disabled):not([data-loading]),
	[data-variant='secondary']:hover:not(:disabled):not([data-loading]) {
		background: var(--surface-subtle);
		border-color: var(--border-strong);
		box-shadow: var(--shadow-sm);
		transform: translateY(-1px);
	}

	/* Tertiary/Outline Button - Transparent with border */
	.btn-outline-primary,
	.btn-outline,
	[data-variant='outline'],
	[data-variant='tertiary'] {
		background: transparent;
		color: var(--accent-primary);
		border-color: var(--accent-primary);
		box-shadow: none;
	}

	.btn-outline-primary:hover:not(:disabled):not([data-loading]),
	.btn-outline:hover:not(:disabled):not([data-loading]),
	[data-variant='outline']:hover:not(:disabled):not([data-loading]),
	[data-variant='tertiary']:hover:not(:disabled):not([data-loading]) {
		background: var(--accent-primary);
		color: var(--text-inverse);
		border-color: var(--accent-primary);
		box-shadow: var(--shadow-sm);
		transform: translateY(-1px);
	}

	/* Outline Secondary - Neutral outline */
	.btn-outline-secondary,
	[data-variant='outline-secondary'] {
		background: transparent;
		color: var(--text-primary);
		border-color: var(--border-strong);
		box-shadow: none;
	}

	.btn-outline-secondary:hover:not(:disabled):not([data-loading]),
	[data-variant='outline-secondary']:hover:not(:disabled):not([data-loading]) {
		background: var(--surface-subtle);
		border-color: var(--color-primary);
		box-shadow: var(--shadow-xs);
		transform: translateY(-1px);
	}

	/* Ghost Button - Minimal for tertiary actions */
	.btn-ghost,
	[data-variant='ghost'] {
		background: transparent;
		color: var(--text-secondary);
		border-color: transparent;
		box-shadow: none;
	}

	.btn-ghost:hover:not(:disabled):not([data-loading]),
	[data-variant='ghost']:hover:not(:disabled):not([data-loading]) {
		background: var(--surface-muted);
		color: var(--text-primary);
		transform: none;
	}

	/* Danger Button - Destructive actions */
	.btn-danger,
	[data-variant='danger'] {
		background: var(--state-danger);
		color: var(--text-inverse);
		border-color: transparent;
		box-shadow:
			0 var(--border-width-thin) var(--spacing-1) rgba(var(--color-danger-rgb), var(--opacity-medium)),
			0 var(--border-width-thin) var(--spacing-2) rgba(var(--color-danger-rgb), var(--opacity-low));
	}

	.btn-danger:hover:not(:disabled):not([data-loading]),
	[data-variant='danger']:hover:not(:disabled):not([data-loading]) {
		background: var(--state-danger-strong);
		box-shadow:
			0 var(--spacing-1) var(--spacing-2) rgba(var(--color-danger-rgb), var(--opacity-medium-high)),
			0 var(--spacing-2) var(--spacing-1) rgba(var(--color-danger-rgb), var(--opacity-medium));
		transform: translateY(-1px);
	}

	/* Glass Morphism Variant */
	.btn-glass,
	[data-variant='glass'] {
		background: rgba(var(--color-white-rgb), var(--opacity-low));
		-webkit-backdrop-filter: blur(var(--glass-blur-amount));
		backdrop-filter: blur(var(--glass-blur-amount));
		border-color: rgba(var(--color-white-rgb), var(--opacity-medium));
		color: var(--text-primary);
		box-shadow:
			var(--shadow-sm),
			inset 0 var(--border-width-thin) 0 rgba(var(--color-white-rgb), var(--opacity-medium));
	}

	.btn-glass:hover:not(:disabled):not([data-loading]),
	[data-variant='glass']:hover:not(:disabled):not([data-loading]) {
		background: rgba(var(--color-white-rgb), var(--opacity-medium));
		border-color: rgba(var(--color-white-rgb), var(--opacity-medium-high));
		transform: translateY(-1px);
	}

	/* Glass + Primary combination */
	.btn-glass.btn-primary,
	[data-variant='glass'][data-color='primary'] {
		background: rgba(var(--color-primary-rgb), var(--opacity-medium));
		border-color: rgba(var(--color-primary-rgb), var(--opacity-medium-high));
		color: var(--text-inverse);
	}

	.btn-glass.btn-primary:hover:not(:disabled):not([data-loading]),
	[data-variant='glass'][data-color='primary']:hover:not(:disabled):not([data-loading]) {
		background: rgba(var(--color-primary-rgb), var(--opacity-medium-high));
		border-color: rgba(var(--color-primary-rgb), var(--glass-opacity-medium));
	}

	/* ========================================= */
	/* BUTTON SIZES (data-size)                  */
	/* ========================================= */

	/* Extra Small */
	.btn-xs,
	[data-size='xs'] {
		padding: var(--spacing-1) var(--spacing-3);
		font-size: var(--font-size-xs);
		border-radius: var(--border-radius);
		gap: var(--spacing-1);
	}

	/* Small */
	.btn-sm,
	[data-size='sm'] {
		padding: var(--spacing-2) var(--spacing-4);
		font-size: var(--font-size-sm);
		border-radius: var(--border-radius-md);
	}

	/* Medium - Default (already defined in base, included for completeness) */
	/* .btn-md and [data-size='md'] use base button padding defined above */

	/* Large */
	.btn-lg,
	[data-size='lg'] {
		padding: var(--spacing-4) var(--spacing-8);
		font-size: var(--font-size-lg);
		border-radius: var(--border-radius-xl);
		gap: var(--spacing-3);
	}

	/* Extra Large */
	.btn-xl,
	[data-size='xl'] {
		padding: var(--spacing-5) var(--spacing-10);
		font-size: var(--font-size-xl);
		border-radius: var(--border-radius-2xl);
		gap: var(--spacing-3);
	}

	/* ========================================= */
	/* BUTTON STATES & MODIFIERS                 */
	/* ========================================= */

	/* Full-width block button */
	.btn-block,
	[data-block='true'] {
		width: 100%;
	}

	/* Icon-only button - Square aspect ratio */
	.btn-icon-only,
	[data-icon-only='true'] {
		padding: var(--spacing-3);
		min-width: calc(var(--spacing-3) * 2 + 1.5em);
		min-height: calc(var(--spacing-3) * 2 + 1.5em);
		aspect-ratio: 1;
	}

	[data-icon-only='true'][data-size='xs'] {
		padding: var(--spacing-1);
		min-width: calc(var(--spacing-1) * 2 + 1.25em);
		min-height: calc(var(--spacing-1) * 2 + 1.25em);
	}

	[data-icon-only='true'][data-size='sm'] {
		padding: var(--spacing-2);
		min-width: calc(var(--spacing-2) * 2 + 1.25em);
		min-height: calc(var(--spacing-2) * 2 + 1.25em);
	}

	[data-icon-only='true'][data-size='lg'] {
		padding: var(--spacing-4);
		min-width: calc(var(--spacing-4) * 2 + 1.75em);
		min-height: calc(var(--spacing-4) * 2 + 1.75em);
	}

	[data-icon-only='true'][data-size='xl'] {
		padding: var(--spacing-5);
		min-width: calc(var(--spacing-5) * 2 + 2em);
		min-height: calc(var(--spacing-5) * 2 + 2em);
	}

	/* Loading state */
	.btn-loading,
	[data-loading='true'] {
		color: transparent !important;
		pointer-events: none;
		position: relative;
	}

	.btn-loading .btn-content,
	[data-loading='true'] .btn-content {
		color: currentColor;
	}

	.btn-loading .btn-text,
	[data-loading='true'] .btn-text {
		visibility: hidden;
	}

	/* Disabled state */
	.btn:disabled,
	.btn[aria-disabled='true'],
	[data-button]:disabled,
	[data-button][aria-disabled='true'] {
		opacity: 0.6;
		cursor: not-allowed;
		transform: none !important;
	}

	/* ========================================= */
	/* DARK MODE ADJUSTMENTS                     */
	/* ========================================= */

	:global(html.dark) .btn::before,
	:global(html.dark) [data-button]::before {
		background: linear-gradient(
			to bottom,
			rgba(var(--color-white-rgb), var(--opacity-very-low)) 0%,
			rgba(var(--color-white-rgb), 0) 50%,
			rgba(var(--color-black-rgb), var(--opacity-low)) 100%
		);
	}

	:global(html.dark) .btn-secondary,
	:global(html.dark) [data-variant='secondary'] {
		background: rgba(var(--color-white-rgb), var(--opacity-very-low));
		border-color: rgba(var(--color-white-rgb), var(--opacity-low));
		color: var(--text-primary);
	}

	:global(html.dark) .btn-secondary:hover:not(:disabled):not([data-loading]),
	:global(html.dark) [data-variant='secondary']:hover:not(:disabled):not([data-loading]) {
		background: rgba(var(--color-white-rgb), var(--opacity-low));
		border-color: rgba(var(--color-white-rgb), var(--opacity-medium));
	}

	:global(html.dark) .btn-outline-secondary,
	:global(html.dark) [data-variant='outline-secondary'] {
		border-color: rgba(var(--color-white-rgb), var(--opacity-medium));
	}

	:global(html.dark) .btn-outline-secondary:hover:not(:disabled):not([data-loading]),
	:global(html.dark) [data-variant='outline-secondary']:hover:not(:disabled):not([data-loading]) {
		background: rgba(var(--color-white-rgb), var(--opacity-very-low));
		border-color: rgba(var(--color-white-rgb), var(--opacity-medium-high));
	}

	:global(html.dark) .btn-ghost:hover:not(:disabled):not([data-loading]),
	:global(html.dark) [data-variant='ghost']:hover:not(:disabled):not([data-loading]) {
		background: rgba(var(--color-white-rgb), var(--opacity-very-low));
	}

	:global(html.dark) .btn-glass,
	:global(html.dark) [data-variant='glass'] {
		background: rgba(var(--color-white-rgb), var(--opacity-very-low));
		border-color: rgba(var(--color-white-rgb), var(--opacity-low));
	}

	:global(html.dark) .btn-glass:hover:not(:disabled):not([data-loading]),
	:global(html.dark) [data-variant='glass']:hover:not(:disabled):not([data-loading]) {
		background: rgba(var(--color-white-rgb), var(--opacity-low));
		border-color: rgba(var(--color-white-rgb), var(--opacity-medium));
	}


	/* ========================================= */
	/* ANIMATION UTILITIES                       */
	/* ========================================= */

	/* Ripple effect on click */
	@keyframes btn-ripple {
		to {
			transform: scale(var(--scale-150));
			opacity: 0;
		}
	}

	.btn::after,
	[data-button]::after {
		content: '';
		position: absolute;
		width: 100%;
		height: 100%;
		border-radius: var(--border-radius-full);
		background: currentColor;
		opacity: 0;
		transform: scale(var(--scale-0));
		pointer-events: none;
	}

	.btn:active::after,
	[data-button]:active::after {
		animation: btn-ripple var(--motion-duration-normal) var(--motion-ease-out);
	}

	/* ========================================= */
	/* LEGACY COMPATIBILITY                      */
	/* ========================================= */

	/* Keep some legacy classes for backward compatibility */
	.control-button-rounded {
		border-radius: var(--border-radius-md) !important;
	}

	.control-button-rounded:hover,
	.control-button-rounded:focus {
		background-color: var(--color-primary) !important;
		color: var(--color-background) !important;
	}

	/* ========================================= */
	/* ACCESSIBILITY ENHANCEMENTS                */
	/* ========================================= */

	/* High contrast mode adjustments */
	@media (--prefers-high-contrast) {
		.btn,
		[data-button] {
			border-width: var(--border-width-medium);
		}

		.btn:focus-visible,
		[data-button]:focus-visible {
			outline-width: var(--border-width-thick);
		}
	}

	/* Reduced motion preferences */
	@media (--prefers-reduced-motion) {
		.btn,
		[data-button] {
			transition: none;
		}

		.btn::before,
		.btn::after,
		[data-button]::before,
		[data-button]::after {
			animation: none;
		}

		.btn:hover:not(:disabled):not([data-loading]),
		[data-button]:hover:not(:disabled):not([data-loading]) {
			transform: none;
		}

		.btn:active:not(:disabled):not([data-loading]),
		[data-button]:active:not(:disabled):not([data-loading]) {
			transform: scale(var(--scale-95));
		}
	}
}
