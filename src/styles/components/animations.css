/**
 * Scroll Animation Classes
 * Part of CSS Refactor Phase 4 - Performance & Accessibility
 * 
 * Features:
 * - GPU-accelerated animations
 * - Reduced motion support
 * - Optimized will-change usage
 * - WCAG AAA compliant animations
 */

@layer components {
	/* Prevent flash of unstyled content for animated elements */
	[data-animate]:not(.animate-in) {
		opacity: 0;
		transform: translateY(var(--transform-distance-md));
		/* GPU acceleration for smoother animations */
		backface-visibility: hidden;
		transform: translate3d(0, var(--transform-distance-md), 0);
	}

	/* Ensure main content is more visible on mobile */
	@media (--mq-md-down) {
		/* Reduce initial transform distance on mobile for better visibility */
		[data-animate]:not(.animate-in) {
			transform: translate3d(0, var(--transform-distance-sm), 0);
		}

		/* Faster animation trigger for mobile */
		[data-animate] {
			transition:
				opacity var(--anim-duration-slow) var(--anim-ease-mobile),
				transform var(--anim-duration-slow) var(--anim-ease-mobile);
		}
	}

	/* Ensure smooth page transitions */
	.main-content-area {
		opacity: 1;
		transition: opacity var(--anim-duration-fast) var(--anim-ease-in-out);
		/* Containment for better performance */
		contain: layout style;
	}

	/* Page transition states */
	.page-transitioning .main-content-area {
		opacity: 0;
	}

	/* Base animation states */
	.animate-in {
		opacity: 1 !important;
		transform: translate3d(0, 0, 0) !important;
		/* Remove will-change after animation completes */
		will-change: auto;
	}

	.animate-out {
		opacity: 0 !important;
		transform: translate3d(0, var(--transform-distance-lg), 0) !important;
	}

	/* Fade animations */
	.fade-in {
		animation: fadeIn var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	.fade-in-up {
		animation: fadeInUp var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	.fade-in-down {
		animation: fadeInDown var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	.fade-in-left {
		animation: fadeInLeft var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	.fade-in-right {
		animation: fadeInRight var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	/* Scale animations */
	.scale-in {
		animation: scaleIn var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	.scale-in-center {
		animation: scaleInCenter var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	/* Slide animations */
	.slide-in-up {
		animation: slideInUp var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	.slide-in-down {
		animation: slideInDown var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	.slide-in-left {
		animation: slideInLeft var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	.slide-in-right {
		animation: slideInRight var(--anim-duration-base) var(--anim-ease-base) forwards;
	}

	/* Bounce animations */
	.bounce-in {
		animation: bounceIn var(--anim-duration-bounce) var(--anim-ease-bounce) forwards;
	}

	/* Stagger delays for lists */
	.stagger-1 {
		animation-delay: var(--anim-delay-1);
	}
	.stagger-2 {
		animation-delay: var(--anim-delay-2);
	}
	.stagger-3 {
		animation-delay: var(--anim-delay-3);
	}
	.stagger-4 {
		animation-delay: var(--anim-delay-4);
	}
	.stagger-5 {
		animation-delay: var(--anim-delay-5);
	}
	.stagger-6 {
		animation-delay: var(--anim-delay-6);
	}

	/* Reading progress bar */
	.reading-progress {
		position: fixed;
		top: 0;
		left: 0;
		width: 0%;
		height: var(--spacing-1);
		background: linear-gradient(
			90deg,
			var(--color-primary),
			var(--color-highlight),
			var(--color-accent)
		);
		z-index: 1000;
		transition: width var(--anim-duration-progress) var(--anim-ease-out);
		/* Performance optimization */
		will-change: width;
		contain: strict;
	}

	/* Parallax container */
	.parallax-container {
		overflow: hidden;
		position: relative;
		/* Performance optimization */
		contain: layout style paint;
	}

	.parallax-element {
		/* Only hint will-change when actually animating */
		backface-visibility: hidden;
		transform: translateZ(0);
	}

	/* Performance optimizations - only apply will-change to actively animating elements */
	.animate-in,
	.animate-out,
	[class*='fade-in'],
	[class*='scale-in'],
	[class*='slide-in'],
	.bounce-in {
		/* GPU acceleration */
		backface-visibility: hidden;
		transform: translateZ(0);
	}

	/* Apply will-change only during animation */
	[data-animate]:not(.animate-in),
	.fade-in,
	.fade-in-up,
	.fade-in-down,
	.fade-in-left,
	.fade-in-right,
	.scale-in,
	.scale-in-center,
	.slide-in-up,
	.slide-in-down,
	.slide-in-left,
	.slide-in-right,
	.bounce-in {
		will-change: opacity, transform;
	}

	/* Remove will-change after animation completes */
	.animation-complete,
	.animate-in.animation-complete {
		will-change: auto;
	}

	/* ==========================================================================
	   KEYFRAME DEFINITIONS
	   All keyframes use translate3d for GPU acceleration
	   ========================================================================== */

	@keyframes fadeIn {
		from {
			opacity: 0;
		}
		to {
			opacity: 1;
		}
	}

	@keyframes fadeInUp {
		from {
			opacity: 0;
			transform: translate3d(0, var(--transform-distance-lg), 0);
		}
		to {
			opacity: 1;
			transform: translate3d(0, 0, 0);
		}
	}

	@keyframes fadeInDown {
		from {
			opacity: 0;
			transform: translate3d(0, calc(-1 * var(--transform-distance-lg)), 0);
		}
		to {
			opacity: 1;
			transform: translate3d(0, 0, 0);
		}
	}

	@keyframes fadeInLeft {
		from {
			opacity: 0;
			transform: translate3d(calc(-1 * var(--transform-distance-lg)), 0, 0);
		}
		to {
			opacity: 1;
			transform: translate3d(0, 0, 0);
		}
	}

	@keyframes fadeInRight {
		from {
			opacity: 0;
			transform: translate3d(var(--transform-distance-lg), 0, 0);
		}
		to {
			opacity: 1;
			transform: translate3d(0, 0, 0);
		}
	}

	@keyframes scaleIn {
		from {
			opacity: 0;
			transform: scale3d(var(--scale-90), var(--scale-90), 1);
		}
		to {
			opacity: 1;
			transform: scale3d(var(--scale-100), var(--scale-100), 1);
		}
	}

	@keyframes scaleInCenter {
		from {
			opacity: 0;
			transform: scale3d(var(--transform-scale-sm), var(--transform-scale-sm), 1)
				translate3d(0, var(--transform-distance-md), 0);
		}
		to {
			opacity: 1;
			transform: scale3d(var(--scale-100), var(--scale-100), 1) translate3d(0, 0, 0);
		}
	}

	@keyframes slideInUp {
		from {
			opacity: 0;
			transform: translate3d(0, var(--transform-distance-full), 0);
		}
		to {
			opacity: 1;
			transform: translate3d(0, 0, 0);
		}
	}

	@keyframes slideInDown {
		from {
			opacity: 0;
			transform: translate3d(0, calc(-1 * var(--transform-distance-full)), 0);
		}
		to {
			opacity: 1;
			transform: translate3d(0, 0, 0);
		}
	}

	@keyframes slideInLeft {
		from {
			opacity: 0;
			transform: translate3d(calc(-1 * var(--transform-distance-full)), 0, 0);
		}
		to {
			opacity: 1;
			transform: translate3d(0, 0, 0);
		}
	}

	@keyframes slideInRight {
		from {
			opacity: 0;
			transform: translate3d(var(--transform-distance-full), 0, 0);
		}
		to {
			opacity: 1;
			transform: translate3d(0, 0, 0);
		}
	}

	@keyframes bounceIn {
		0% {
			opacity: 0;
			transform: scale3d(var(--transform-scale-xs), var(--transform-scale-xs), 1)
				translate3d(0, var(--transform-distance-lg), 0);
		}
		50% {
			opacity: 1;
			transform: scale3d(var(--transform-scale-lg), var(--transform-scale-lg), 1)
				translate3d(0, calc(-1 * var(--transform-distance-sm)), 0);
		}
		70% {
			transform: scale3d(var(--transform-scale-md), var(--transform-scale-md), 1)
				translate3d(0, calc(var(--transform-distance-sm) / 2), 0);
		}
		100% {
			opacity: 1;
			transform: scale3d(var(--scale-100), var(--scale-100), 1) translate3d(0, 0, 0);
		}
	}

	/* ==========================================================================
	   REDUCED MOTION SUPPORT
	   WCAG AAA compliance - respects user motion preferences
	   ========================================================================== */

	@media (--prefers-reduced-motion) {
		/* Disable all animations */
		.fade-in,
		.fade-in-up,
		.fade-in-down,
		.fade-in-left,
		.fade-in-right,
		.scale-in,
		.scale-in-center,
		.slide-in-up,
		.slide-in-down,
		.slide-in-left,
		.slide-in-right,
		.bounce-in {
			animation: none !important;
			opacity: 1 !important;
			transform: none !important;
		}

		/* Instant transitions */
		.reading-progress {
			transition: none;
		}

		/* No parallax effect */
		.parallax-element {
			transform: none !important;
		}

		/* Instant page transitions */
		.main-content-area {
			transition: none;
		}

		/* Show content immediately */
		[data-animate]:not(.animate-in) {
			opacity: 1;
			transform: none;
		}

		/* Remove will-change */
		*[will-change] {
			will-change: auto !important;
		}
	}

	/* ==========================================================================
	   HIGH CONTRAST MODE SUPPORT
	   Ensures animations are visible in high contrast mode
	   ========================================================================== */

	@media (prefers-contrast: high) {
		/* Ensure visibility during animations */
		[data-animate]:not(.animate-in) {
			opacity: 0.3; /* Slightly visible instead of fully transparent */
		}

		/* Stronger focus indicators during animations */
		.fade-in:focus,
		.slide-in-up:focus,
		[data-animate]:focus {
			outline: 3px solid currentColor;
			outline-offset: 3px;
		}
	}

} /* End @layer components */
